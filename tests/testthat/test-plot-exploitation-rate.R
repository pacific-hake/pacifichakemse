context("Test the plot_exploitation_rate() function")

ps <- readRDS("ps_c.rds")

test_that("plot_exploitation_rate() - Tests for argument errors", {
  expect_error(plot_exploitation_rate(ps = NULL, ci = c(0.05, 0.95)))
  expect_error(plot_exploitation_rate(ps = ps, ci = NULL))
  expect_error(plot_exploitation_rate(ps = ps, ci = c(0.05, 0.94)))
  expect_error(plot_exploitation_rate(ps = ps, ci = c("a", "b")))
  expect_error(plot_exploitation_rate(ps = ps, ci = c(0.05, 0.5, 0.95)))
  ps_no_median <- ps
  tmpnames <- names(ps$mse_quants$f0_quant)
  tmpnames[6] <- "notright"
  names(ps_no_median$mse_quants$f0_quant) <- tmpnames
  expect_error(plot_exploitation_rate(ps = ps_no_median,
                                      ci = c(0.05, 0.95)))

})

test_that("plot_exploitation_rate() - Tests for plots matching previous ones", {
  p <- plot_exploitation_rate(ps = ps, ci = c(0.05, 0.95))
  vdiffr::expect_doppelganger("plot-exploitation-rate", p)
  # Use following command to add new plots
  # vdiffr::manage_cases()
})

